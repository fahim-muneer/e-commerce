{% extends "adminbase.html" %}

{% block title %} category {% endblock title %}
{% block heading %} Category {% endblock heading %}

{% block context %}
<body class="bg-gray-50 p-4 sm:p-8">
    <div class="bg-white rounded-lg shadow-xl p-8 max-w-5xl w-full mx-auto my-8">
        <!-- Page Header -->
        <div class="flex items-center justify-between mb-6">
            <h1 class="text-2xl font-bold text-gray-800">Category List</h1>

            <!-- Right side (Button above Search Bar) -->
            <div class="flex flex-col items-end space-y-3">
                <!-- Add Category Button -->
                <a href="{% url 'add_category' %}">
                    <button class="px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200">
                        ADD CATEGORY
                    </button>
                </a>

                <!-- Search bar -->
                <div class="flex items-center space-x-2 w-full sm:w-60 md:w-72">
                    <!-- Search form -->
                    <form method="get" action="{% url 'category_list' %}" class="relative flex-1">
                        <input type="text" id="searchInput" name="q" value="{{ request.GET.q }}" 
                               placeholder="Search categories..." 
                               class="block w-full rounded-md border-gray-300 shadow-sm 
                                      focus:border-blue-500 focus:ring-blue-500 pl-10 pr-4 py-2 text-sm">
                        <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                            <svg class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.145l4.145 4.145a.5.5 0 01-.707.707l-4.145-4.145A7 7 0 012 9z" clip-rule="evenodd" />
                            </svg>
                        </div>
                    </form>

                    <!-- Clear button -->
                    <a href="{% url 'category_list' %}" id="clearSearch" 
                       class="px-3 py-2 bg-gray-500 text-white text-sm font-medium rounded-md hover:bg-gray-600 transition-colors duration-200 
                              {% if not request.GET.q %}opacity-50 cursor-not-allowed{% endif %}" 
                       {% comment %} {% if not request.GET.q %}onclick="return false;"{% endif %}> {% endcomment %} 
                    >Clear
                    </a>
                </div>
            </div>
        </div>

        <!-- Table Container -->
        <div class="overflow-x-auto rounded-md border border-gray-200">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">No.</th>

                        <th scope="col" class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">CATEGORY ICON</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">CATEGORY NAME</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">ACTION</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    {% for i in category %}
                    <!-- Category Row -->
                    <tr class="category-row">
                        <td  class="px-6 py-4 whitespace-nowrap" >{{ forloop.counter|add:category.start_index|add:"-1" }}</td>

                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                             <img src="{{i.image.url}}" alt="{{i.name}}" class="w-8 h-8 rounded object-cover">
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 category-name">
                            {{i.name}}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <a href="{% url 'update_category' pk=i.pk %}" class="text-gray-500 hover:text-blue-600 px-2 py-1 rounded hover:bg-blue-50 transition-colors duration-200" title="Edit Category">
                                <i class="fa-solid fa-pen-to-square"></i>
                            </a>
                            <a href="{% url 'delete_category' pk=i.pk %}" class="text-gray-500 hover:text-red-600 px-2 py-1 rounded hover:bg-red-50 transition-colors duration-200" title="Delete Category" onclick="return confirm('Are you sure you want to delete this category?')">
                                <i class="fa-solid fa-trash"></i>
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="3" class="px-6 py-4 text-center text-gray-500">No categories found</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

    <!-- Pagination -->
            <div class="flex justify-center space-x-2 mt-8">
                {% if user.has_previous %}
                <a href="?page={{ category.previous_page_number }}" class="px-4 py-2 border rounded-md text-gray-700 hover:bg-gray-100">&lt;</a>
                {% endif %}

                {% for i in category.paginator.page_range %}
                <a href="?page={{ i }}" class="px-4 py-2 border rounded-md text-gray-700 hover:bg-gray-100">{{ i }}</a>
                {% endfor %}

                {% if user.has_next %}
                <a href="?page={{ category.next_page_number }}" class="px-4 py-2 border rounded-md text-gray-700 hover:bg-gray-100">&gt;</a>
                {% endif %}
            </div>

           
        </div>
    </div>

{% comment %} <script>
// Search functionality for categories
document.getElementById('searchInput').addEventListener('input', function() {
    const searchTerm = this.value.toLowerCase();
    const rows = document.querySelectorAll('.category-row');
    const clearBtn = document.getElementById('clearSearch');
    
    // Show/hide clear button based on input value
    if (this.value.trim() !== '') {
        clearBtn.classList.remove('opacity-50', 'cursor-not-allowed');
        clearBtn.onclick = null;
    } else {
        clearBtn.classList.add('opacity-50', 'cursor-not-allowed');
        clearBtn.onclick = function() { return false; };
    }
    
    rows.forEach(row => {
        const name = row.querySelector('.category-name').textContent.toLowerCase();
        
        if (name.includes(searchTerm)) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
});
</script> {% endcomment %}

</body>


{% endblock context %}